!function(e){"function"==typeof define&&define.amd?define([],e):e(this)}(function(e){var t,n=/$^/,r=function(e,t){return r["undefined"==typeof t?"compile":"render"].apply(r,arguments)};e.HUI=e.HUI||{},e.HUI.template=r,r.version="0.1.0",r._cache=t={},r.tags={beginTag:"{{",endTag:"}}",varBeginTag:"#{",varEndTag:"}"},r.syntaxRules={evaluate:"$bt\\s*eval\\:([\\s\\S]+?(\\}?)+)$et",interpolate:"$bt(s*[^!][\\s\\S]*?)$et",unescape:"$bt!([\\s\\S]+?)$et",conditional:"$bt\\s*\\/?(?:if|(elif|elseif|else))\\:?\\s*([\\s\\S]*?)\\s*$et",iterate:"$bt\\s*\\/?for\\:?(?:\\s*([\\w$]+)\\s*(?:\\,\\s*([\\w$]+))?\\s*in)?(\\s*[\\s\\S]*?)\\s*$et",include:"$bt\\s*include:\\s*([^}]*?)\\s*,\\s*([^}]*?)$et"};var a={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;","/":"&#47;"},i=function(e){return"string"!=typeof e?e:e.replace(/&(?![\w#]+;)|[<>"'\/]/g,function(e){return a[e]})},o=function(e){return e.replace(/([\/()[\]?{}|*+-.$^])/g,"\\$1")},u=function(e){return e.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")},c=function(e,t,n){return n=n.replace(/\$bt/g,o(e)).replace(/\$et/g,o(t)),new RegExp(n,"ig")},l=function(){var e=r.syntaxRules,t=r.tags.beginTag,n=r.tags.endTag,a=r.tags.varBeginTag,i=r.tags.varEndTag;return{conditional:c(t,n,e.conditional),interpolate:c(a,i,e.interpolate),unescape:c(a,i,e.unescape),iterate:c(t,n,e.iterate),evaluate:c(t,n,e.evaluate),include:c(t,n,e.include)}},s=function(e){var t,r,a,i=l(),o=0,c="\"use strict\";var espHTML = this._escapeHTML,initTmpl = this._template,_out='';_out+='";return c+=e.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,"").replace(/'|\\/g,"\\$&").replace(i.interpolate||n,function(e,t){return"'+ espHTML("+u(t)+")+'"}).replace(i.unescape||n,function(e,t){return"'+("+u(t)+")+'"}).replace(i.conditional||n,function(e,t,n){return t?n?"';} else if("+u(n)+"){_out+='":"';} else {_out+='":n?"';if("+u(n)+") {_out+='":"';} _out+='"}).replace(i.iterate||n,function(e,n,i,c){return c?(o++,t=n||"$val",a=i||"$idx",loopI="i"+o,r="arr"+o,c=u(c),"';var "+r+"="+c+";if("+r+") {var "+t+","+a+";for(var "+loopI+"=0; "+loopI+"<"+r+".length; "+loopI+"++){"+a+"="+loopI+","+t+"="+r+"["+loopI+"];_out+='"):"';} } _out+='"}).replace(i.include||n,function(e,t,n){return"'; _out+=initTmpl('"+t+"',"+n+"); _out+='"}).replace(i.evaluate||n,function(e,t){return"';"+u(t)+"; _out+='"}).replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r"),c+="';return _out;",c.replace(/(\s|;|\}|^|\{)_out\+='';/g,"$1")},p=function(e){var t=s(e);try{return new Function("it",t)}catch(n){throw"undefined"!=typeof console&&console.log("Can't create tmpl function: "+t),n}};r.script=s,r.Engine=function(e){this._escapeHTML=i,this._template=r,this.render="function"==typeof e?e:p(e)},r.get=function(e){return t.hasOwnProperty(e)?t[e]:null},r.compile=function(n,a){var i,o;if(a)i=n,n=a;else if(o=n.match(/^\s*#([\w:\-\.]+)\s*$/i),o&&(i=o[1],"document"in e)){var u=document.getElementById(i);if(!u)throw"Can't get template!";var c=u.value||u.innerHTML;n=c.replace(/^\s*|\s*$/g,"")}var l=new r.Engine(n);return i&&(t[i]=l),l},r.render=function(e,t){var n=r.get(e)||r.compile(e);return n.render(t)};var f=e.jQuery;f&&!f.prototype.tmplify&&(f.fn.tmplify=function(e){var t=r.compile(this.html());return t.render(e)}),"undefined"!=typeof exports&&(module.exports=r)});